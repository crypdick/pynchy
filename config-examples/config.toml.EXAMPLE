# ============================================================================
# Pynchy Configuration
# ============================================================================
# Copy this file to config.toml and configure for your setup:
#   cp config-examples/config.toml.EXAMPLE config.toml
#
# Most settings have sensible defaults and can be omitted.
# Environment variables override TOML values using __ as the nested delimiter:
#   AGENT__NAME=mybot  →  [agent] name = "mybot"
# ============================================================================

# ─────────────────────────────────────────────────────────────────────────────
# Agent Configuration
# ─────────────────────────────────────────────────────────────────────────────

[agent]
# Name of the assistant (used in trigger detection and message attribution)
# name = "pynchy"

# Trigger aliases (used in addition to agent name for @mentions)
# trigger_aliases = ["ghost"]

# Agent core: "claude" (default) or "openai"
# core = "claude"

# ─────────────────────────────────────────────────────────────────────────────
# API Credentials
# ─────────────────────────────────────────────────────────────────────────────
# These are masked in logs via Pydantic SecretStr.
#
# Option 1: Claude OAuth (recommended)
# Run `claude` CLI to authenticate — no config needed.
#
# Option 2: Anthropic API key
# Option 3: OpenAI API key (set agent.core = "openai")

[secrets]
# anthropic_api_key = "sk-ant-api03-..."
# claude_code_oauth_token = "..."
# openai_api_key = "sk-proj-..."
# gh_token = "ghp_..."

# ─────────────────────────────────────────────────────────────────────────────
# Container Configuration
# ─────────────────────────────────────────────────────────────────────────────

[container]
# Container image name (built via ./container/build.sh)
# image = "pynchy-agent:latest"

# Container timeout in milliseconds (30 minutes default)
# timeout_ms = 1800000

# Maximum container output size in bytes (10MB default)
# max_output_size = 10485760

# Idle timeout in milliseconds (30 minutes default)
# idle_timeout_ms = 1800000

# Maximum concurrent agent containers
# max_concurrent = 5

# Override container runtime detection (usually auto-detected)
# Options: "docker" (built-in), "apple" (requires Apple runtime plugin)
# runtime = "docker"

# ─────────────────────────────────────────────────────────────────────────────
# Server Configuration
# ─────────────────────────────────────────────────────────────────────────────

[server]
# HTTP server port for TUI and deploy endpoint
# port = 8484

# ─────────────────────────────────────────────────────────────────────────────
# Scheduler & Intervals
# ─────────────────────────────────────────────────────────────────────────────

[scheduler]
# Poll interval for scheduled tasks (seconds)
# poll_interval = 60.0

# Timezone for scheduled tasks (auto-detected from system if empty)
# timezone = "America/New_York"

[intervals]
# Message polling interval (seconds)
# message_poll = 2.0

# IPC file polling interval (seconds)
# ipc_poll = 1.0

# Host cron jobs (runs shell commands directly on host, no LLM/container loop)
# [cron_jobs.rebuild_container]
# schedule = "0 5 * * *"
# command = "./container/build.sh"
# cwd = "."
# timeout_seconds = 1200
# enabled = true

# ─────────────────────────────────────────────────────────────────────────────
# Queue Configuration
# ─────────────────────────────────────────────────────────────────────────────

[queue]
# max_retries = 5
# base_retry_seconds = 5.0

# ─────────────────────────────────────────────────────────────────────────────
# Channel Selection
# ─────────────────────────────────────────────────────────────────────────────
# Channels and optional host runtimes are now provided by plugins managed via
# [plugins.*] entries below.

[channels]
# Default channel plugin name used for first-run group creation.
# Set to "tui" to keep core UI-only mode (default behavior).
# Use a plugin channel name (e.g. "whatsapp") to auto-create external first-run groups.
# With "tui", pynchy still bootstraps a local first-run workspace automatically.
# default = "tui"

# ─────────────────────────────────────────────────────────────────────────────
# Plugins (config-managed repositories)
# ─────────────────────────────────────────────────────────────────────────────
# On startup, pynchy ensures enabled plugin repositories are cloned/updated
# under ~/.config/pynchy/plugins/<plugin_name>.
#
# [plugins.whatsapp]
# repo = "crypdick/pynchy-plugin-whatsapp"
# ref = "main"   # branch, tag, or commit SHA
# enabled = true
#
# Optional: Apple Container runtime provider (macOS)
# [plugins.apple-runtime]
# repo = "crypdick/pynchy-plugin-apple-runtime"
# ref = "main"
# enabled = true

# ─────────────────────────────────────────────────────────────────────────────
# Workspace Defaults
# ─────────────────────────────────────────────────────────────────────────────
# Defaults applied to workspaces that don't override these fields.

[workspace_defaults]
# requires_trigger = true
# context_mode = "group"

# ─────────────────────────────────────────────────────────────────────────────
# Workspaces
# ─────────────────────────────────────────────────────────────────────────────
# Each [workspaces.<folder_name>] defines a workspace. The folder name matches
# the directory under groups/.

[workspaces.admin]
is_god = true
requires_trigger = false

[workspaces.mr-pynchy]
is_god = true
requires_trigger = false

# Plugins can provide additional managed workspaces automatically
# (for example, the `code-improver` periodic agent for pynchy core).

# ─────────────────────────────────────────────────────────────────────────────
# Command Words (magic commands)
# ─────────────────────────────────────────────────────────────────────────────
# Customize the words that trigger special commands.

# [commands.reset]
# verbs = ["reset", "restart", "clear", "new", "wipe"]
# nouns = ["context", "session", "chat", "conversation"]
# aliases = ["boom", "c"]

# [commands.end_session]
# verbs = ["end", "stop", "close", "finish"]
# nouns = ["session"]
# aliases = ["done", "bye", "goodbye", "cya"]

# [commands.redeploy]
# aliases = ["r"]
# verbs = ["redeploy", "deploy"]

# ─────────────────────────────────────────────────────────────────────────────
# CalDAV (Calendar)
# ─────────────────────────────────────────────────────────────────────────────
# Built-in host-side plugin. Connects to any CalDAV server (Nextcloud, etc.)
# and exposes list_calendar, create_event, delete_event tools to agents.
# Multiple calendars on the same server are supported — agents pass the
# calendar name. Only one server is supported currently.

# [caldav]
# url = "https://nextcloud.example.com/remote.php/dav/"
# username = "user@example.com"
# password = "app-password-here"
# default_calendar = "personal"   # what "primary" resolves to

# ─────────────────────────────────────────────────────────────────────────────
# Security
# ─────────────────────────────────────────────────────────────────────────────
# Default blocked patterns for mount security. These are merged with patterns
# from the mount-allowlist.toml file.

# [security]
# blocked_patterns = [".ssh", ".gnupg", ".gpg", ".aws", ...]
